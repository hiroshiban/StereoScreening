function generateDesign(Subjects,Designs,Conditions,Reps,lookBack,outputDir)% generate multiple design files for multiple subjects% parameters:% Subjects - number of subjects to generate designs for% Designs - number of design files per subject% Conditions - number of conditions in the experiment (including fixation)% Reps - number of repeats of a sequence of conditions% lookBack - number of previous trials which form a combination which is % equally likely to appear in the trial sequence% outputDir - directory to create design files into - this directory must% exist%% Note: if the design file already exists then it will be overwritten if% the same output directory is specified twice% example:% generateDesign(5,10,8,2,1,'d:\designs')% will create 5 subject folders named 'subject 1' etc.% for each subject there will be 10 design files named design1.txt etc. in% the relevant design folderrand('state',sum(100*clock));if (~isdir(outputDir))    error('output directory is invalid');end        targetDir=fullfile(outputDir,'\');% for each subjectfor subj = 1:Subjects % number of subjects to generate trials for        % create subject directory if it doesn't already exists    subjectDir = fullfile(targetDir, sprintf('%s %d','subject' ,subj), '\');    if ~isdir(subjectDir)           mkdir(subjectDir);    end    % create design file for each run    for run =1:Designs            % generate filename for each design file            designFileName = fullfile (subjectDir,'\',sprintf('%s%d%s','design',run,'.txt'));            % generate condition list            % repeatedhistory optionally returns design list and also writes it out            % to the specified file            repeatedhistory(Conditions,Reps,lookBack,char(designFileName));        end    endend